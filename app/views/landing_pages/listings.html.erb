          <!--%= render 'listview' %-->

          <!------------------ MAP VIEW ------------------------>
            <div class="mapbar" id="mapview">
              <% if @offices.count == 0 %>
                <%= gmaps(
                  "map_options" =>  { "provider" => "google",
                              #       "client" => "gme-intuitinc",
                              #       "channel" => "fms.spaces",
                                      "provider_key" => "AIzaSyA63spoPlwAL-NcXhJaU7bOvJyZL2PuKQE",
                                      "auto_zoom" => false,
                                      "libraries" => ["places"],
                                      "detect_location" => true,
                                      "center_on_user" => true 
                                    }
                  )
                %>
            <% else %>
              <%= gmaps(
                      "markers"     =>  {"data" => @json},
                      "map_options" =>  { "provider" => "google",
                                  #       "client" => "gme-intuitinc",
                                  #       "channel" => "fms.spaces",
                                          "provider_key" => "AIzaSyA63spoPlwAL-NcXhJaU7bOvJyZL2PuKQE",
                                          "auto_zoom" => true,
                                          "libraries" => ["places"]
                      }
                    )
                %>
            <% end %>    
                              
              
          </div>
           


            <!-------------------PHOTO VIEW ------------------------>

            <div class="contentbar" id="photoview">
                <div class="searchbar well">
                  <%= render 'searchbar' %>
                </div>

            <div class="resultsbar">


              <% if @offices.count == 0 %>
                <p>
                  Oops! We could not find any offices near your city. Try one of our popular locations -
                  <%= link_to "San Francisco", listings_path(:city => "San Francisco, CA") %> and
                  <%= link_to "San Jose", listings_path(:city => "San Jose, CA")  %>
                  <br /> <br />
                  Didn't find your city?  <%= link_to "Sign up for alerts", "#addAlert", :data => {:toggle=>"modal"} %>, and we'll let you know when a new space is posted in your city. 
                </p>
                            
                <% else %>
                       <% @offices.each do |office| %>

                          <div class="span5 eachoffice-container" id="office<%=office.id%>">
                            <div class="thumbnail" style="padding:0px;">
                              <a href= "<%= office_path(office)  %>" >
                                <div class="office-photo-container fade"> 
                                  <% if (office.office_images.first != nil) %>
                                      <%= cl_image_tag office.office_images.first.path, :size => '460x271', :crop => :fill %>
                                  <% else %>

                                      <!--%= image_tag "http://maps.googleapis.com/maps/api/streetview?size=220x165&location=40.720032,%20-73.988354&fov=90&heading=235&pitch=10&sensor=false", :crop => :fit, :class => "img-polaroid" %-->
                                      <%= image_tag "http://maps.googleapis.com/maps/api/streetview?size=460x271&location=#{office.latitude},%20#{office.longitude}&sensor=false&key=AIzaSyA63spoPlwAL-NcXhJaU7bOvJyZL2PuKQE", :crop => :fill %>
                                  <% end %>
                                  <div class="office-photo-caption text-right"> 
                                   <% if office.size? %><%= office.size %> sq. ft. &#8901; <% end %><% if office.min_lease? %><%= pluralize office.min_lease, 'month', 'months' %> min.<% end %>
                                  </div>
                                </div>
                              </a>
                             
                              <!-- img src="/assets/medium_default-studio.png" alt="" -->
                              <div class="media">
                                <% if office.user && office.user.photo? %>
                                    <img class="media-object pull-left rounded-img margin-sides" src="<%= office.user.photo %>" height="60px" width="60px">
                                <% else %>
                                    <img class="media-object pull-left rounded-img margin-sides" src="/assets/default_person.png" height="60px" width="60px">
                                <% end %>
                                <div class="media-body">
                                   <p> <% if office.type_office==1 %><i class="icon-building orange"></i> Private office/ desk<% end %>
                             <% if office.type_office==2 %><i class="icon-lightbulb orange"></i> Design/ creative space<% end %>
                             <% if office.type_office==3 %><i class="icon-user-md orange"></i> Counseling/ therapy office<% end %>
                             <% if office.type_office==4 %><i class="icon-male orange"></i> Treatment/ bodywork room<% end %> > <%= office.loc_city %></p>

                                  <p class="officecost">
                                     <% if office.rent? %>
                                          <%= number_to_currency(office.rent, :locale => 'en_us', :precision => 0) %>
                                          <% if office.rent_type == 1 %>/month
                                          <% else %>
                                              <% if office.rent_type == 2 %>/week
                                              <% else %>
                                                  <% if office.rent_type == 3 %>/day
                                                  <% else %><span class="small-font">/month</span>
                                                  <% end %>
                                              <% end %>
                                          <% end %>
                                     <% else %>
                                       Contact us for rent
                                     <% end %>
                                    </p>
                                 
                                </div>
                              </div>
                            </div>
                          </div>

                    <% end %>
                 

                <div class="pagemarker span9">
                  <div class="apple_pagination">

                  <!--div class="page_info">
                    <#%= page_entries_info @offices %>
                  </div-->
                  <%= will_paginate @offices, :container => false %>
                  </div>
                  <div class="listing_footer">Haven't found your perfect space? <%= link_to "Sign up for alerts", "#addAlert", :data => {:toggle=>"modal"} %>, and we'll let you know when a new space is posted in your city.</div>
                </div>
              </div>
              <% end %>
            </div>
        
        </div>


<%= render 'alerts/form' %>

<script type="text/javascript">

//  $(".eachoffice-container").hover (
//   function() {
//     $(this).addClass('office-hover');
//   },
//   function() {
//     $(this).removeClass('office-hover');
//   }
// )

// function initialize() {
//         var map;

//         var mapOptions = {
//             center: new google.maps.LatLng(-34.397, 150.644),
//             zoom: 8,
//             mapTypeId: google.maps.MapTypeId.ROADMAP,
//             streetViewControl: false
//         };
//         var map = new google.maps.Map(document.getElementById("mapview"),
//                 mapOptions);

//     }

//     google.maps.event.addDomListener(window, 'load', initialize);

  $(document).ready (function() {
      searchAutocomplete();
      alertAutocomplete();
      iePlaceholderFix();
    });


    function showmapview() {
        $('#listview').hide();
        $('#mapview').attr('class', 'mapfull');
        Gmaps.loadMaps();

    }

    function showlistview() {
        $('#mapview').attr('class', 'mapbar');
        $('#listview').show();
        Gmaps.loadMaps();

    }

    $("#showMapBtn").click(function() {
        $.cookie ('mapview', 'true');
        showmapview();
        mixpanel.track("Clicked MapView button");
    });

    $("#showListBtn").click(function() {
        $.cookie ('mapview', 'false');
        showlistview();
        mixpanel.track("Clicked ListView button");

    });

    $("#searchBtn").click(function() {
        var val = $("#city").val();
        _gaq.push(['_trackEvent', "Search".concat(val), 'User clicks on Search']);
        mixpanel.track("Clicked Search", {location: val});
    });

    $("#search").keyup(function(event){
        if(event.keyCode == 13){
            $("#searchBtn").click();
        }
    });

</script>
