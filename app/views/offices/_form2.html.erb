<%= simple_form_for(@office, :html => { :id => "office_listing" }) do |f| %>
    <% if @office.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@office.errors.count, "error") %> prohibited this listing from being saved:</h2>
          <ul style="margin-left:10;">
            <% @office.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

    



      <div class="listing-header">Tell us about your space</div>
        <div class="row panel panel-border">
        <div id="pano"></div>       
          <fieldset class="padtop_big padbottom_big side-margins">                 

<div class="control-group">
  <label class="control-label">Type of space</label>

  <div class="controls">
    <%= f.select :office_type, [['Office Space', 1], ['Meeting Room', 2], ['Desk', 3]] %>
  </div>
</div>

<div class="control-group">
  <label class="control-label">Accommodates</label>

  <div class="controls">  <%= f.number_field :accomodate, :in => 0..20, :style => "width: 10%" %>  </div>
</div>

<div class="control-group">
  <label class="control-label">Size</label>

  <div class="controls"> <%= f.text_field :size, :style => "width: 10%" %> sq. ft.</div>
</div>

<div class="control-group">
  <label class="control-label">Amenities</label>

  <div class="row">
    <div class="span1.5">
      <label class="checkbox">
        <%= f.check_box :wifi %>
        <div class="officeicon wifi_on"></div>
        Wi-Fi
      </label>
      <label class="checkbox">
        <%= f.check_box :parking %>
        <div class="officeicon park_on"></div>
        Parking
      </label>


    </div>

    <div class="span1.5">
      <label class="checkbox ">
        <%= f.check_box :confroom %>
        <div class="officeicon conf_on"></div>
        Conference Room
      </label>
      <label class="checkbox">
        <%= f.check_box :ac %>
        <div class="officeicon ac_on"></div>
        Air Conditioning
      </label>
    </div>

    <div class="span1.5">
      <label class="checkbox">
        <%= f.check_box :kitchen %>
        <div class="officeicon kitchen_on"></div>
        Kitchen
      </label>
      <label class="checkbox">
        <%= f.check_box :printer %>
        <div class="officeicon printer_on"></div>
        Printer
      </label>

    </div>

    <div class="span1.5">
        <label class="checkbox">
          <%= f.check_box :window %>
          <div class="officeicon window_on"></div>
          Window Office
        </label>
    </div>



<div class= "control-group">
  <label class="control-label">Upload photos (up to 4)</label>
  <div class="controls">
    <button class="btn btn-success span-attachinary-input controls"> <%= f.attachinary_file_field :office_images, :cloudinary => {
                 :eager => [{:width => 600, :height => 400, :crop => :fill, :angle => :exif}]}%><i class="icon-plus icon-white"> </i>
        <span> Add files.... </span></button>
  </div>

 <div class="row ">
  
  <div class="offset2 span10 thumbs"> </div>
  </div>
  </div>

<div class="control-group">
  <label class="control-label">Rent Amount</label>

  <div class="controls">
    <%= f.text_field :rent, :placeholder => "$",  :style => "width: 130px"%> per
    <%= f.select :rent_type, [['Month', 1], ['Week', 2], ['Day', 3]], :style => "width: 10px" %>
  </div>
</div>

<div class="control-group">
  <label class="control-label"><strong>* Title</strong></label>

  <div class="controls"> <%= f.text_field :title, :style => "width: 350px",
                        :placeholder => "e.g. Private Office with conference room" %>
  </div>
</div>

<div class="control-group">
  <label class="control-label">Description</label>

  <div class="controls"> <%= f.text_area :description, :style => "width: 540px", :class => "tinymce",
             :placeholder => "List availability, rental terms, house rules, additional amenities, etc.", :rows => 50 %>
  </div>
</div>

<% if current_user.admin? %>
    <div class="control-group">
     <label class="control-label">Featured Listing:</label>
     <div class="controls"> <%= f.check_box :featured %>  </div>
   </div>
<% end %>

<button class="btn btn-primary btn-large" type="submit" id="saveListingBtn">SAVE MY LISTING</button>
<% end %> 
        </fieldset>
      </div>
<!-- other JS code -->
<script type="text/javascript">

    function showLoadingImage() {
        $('#second').append('<div id="loading-image"><%= image_tag("ajax-loader.gif", :alt => "loading") %> </div>');
    }

    function hideLoadingImage() {
        $('#loading-image').remove();
    }



    $("#continueListingBtn").click(function() {
      $('#pano').show();
      $("#continueListingBtn").hide();
      
      mixpanel.track("Clicked Continue");
    });




    $("#saveListingBtn").click(function() {
      $("#office_listing").validate({
        rules: {
          "office[city]": {required: true},
          "office[title]": {required: true}
        },
        messages: {
          "office[city]": "Please tell us the address or city of your office",
          "office[title]": "Please provide a title for your listing"
        },
        errorPlacement: function(error, element) {
          element.after(error);
          element.css('border', 'solid red 2px');
        }
      });

      if ($("#office_listing").valid()) {
        _gaq.push(['_trackEvent', 'SaveListing', 'User saves a listing']);
      }
    });

    function initializePano() {
      var panoramaOptions = {
        position: new google.maps.LatLng(-34.397, 150.644),
        pov: {
          heading: 34,
          pitch: 10
        }
      };
      var pano = new google.maps.StreetViewPanorama(document.getElementById('pano'),panoramaOptions);

      window.setInterval(function() {
        var pov = pano.getPov();
        pov.heading += 0.2;
        pano.setPov(pov);
      }, 10);
    }
google.maps.event.addDomListener(window, 'load', initializePano);

    

</script>

<%= tinymce_assets %>
<script type="text/javascript">
    tinyMCE.init({
        selector: "textarea",
        theme_advanced_toolbar_location: "top",
        theme_advanced_toolbar_align: "center",
        theme_advanced_buttons1 : "bold, italic, underline, numlist, bullist",
        theme_advanced_buttons2 : "",
        theme_advanced_buttons3 : "",
        theme_advanced_font_sizes: "10px,12px,13px,14px,16px,18px,20px",
        font_size_style_values: "12px,13px,14px,16px,18px,20px",
        height: 250,
        theme_advanced_statusbar_location : "none",
        //content_css : "/tinymce_editor.css?" + new Date().getTime()
        content_css: '<%= asset_path 'application.css' %>'
    });

</script>


<script type="text/javascript">


<!-- file upload -->
$(document).ready(function() {
    $('.attachinary-input').attachinary();

    function showLoadingImage() {
       $('.thumbs').prepend('<div id="loading-image"><%= image_tag("ajax-loader.gif", :alt => "loading") %></div>');

    }

    function hideLoadingImage() {
        $('#loading-image').remove();
    }

    $('.attachinary-input').attachinary();

    $('.attachinary-input').bind('fileuploadstart', function(e, data) {
      //alert ("ok, start");
       //$('#loading-image').show();
       showLoadingImage();
    });

    /*
    $('.attachinary-input').bind('fileuploadprogressall', function(e,data) {
      alert ("progress " + data.loaded);
      var prog = parseInt(data.loaded / data.total * 100, 10);

      $('.progress').css('width', prog + '%');
    });
    */

    $('.attachinary-input').bind('cloudinarydone', function() {
    //alert ("done!");
      //    hideLoadingImage();
    });


    $('.attachinary-input').bind('fileuploaddone', function() {
    //alert ("done event!");
    hideLoadingImage();
    });


    // move the attachinary container to a separate row (this is where the thumbnails show upf)
    $('.thumbs').prepend($('.attachinary_container'));

    //$('.attachinary-input').trigger('fileuploadstart');


//    var input = document.getElementById('office_loc_addr1');
//    var autocomplete = new google.maps.places.Autocomplete(input);
//    autocomplete.setTypes(['geocode']);



});

</script>
